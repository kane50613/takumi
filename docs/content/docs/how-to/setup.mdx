---
title: Setup
description: Learn how to setup and use Takumi for your platform
---

Takumi is built with Rust and designed for portability. You can use it:

<Cards>
  <Card
    title="In Node.js/Bun"
    href="/#for-nodejsbun"
    description="Via the @takumi-rs/core package (N-API) for server-side rendering."
  />
  <Card
    title="In the browser"
    href="#for-webbrowser"
    description="Via the @takumi-rs/wasm package (WebAssembly) for client-side generation."
  />
  <Card
    title="With pre-built HTTP server"
    href="#with-pre-built-http-server"
    description="Host an external server to handle image generation."
  />
  <Card
    title="Directly in Rust"
    href="#for-rust"
    description="For native applications with maximum performance and control."
  />
</Cards>

## For Node.js/Bun

Built with N-API bindings that leverage Node.js's libuv thread pool for optimal performance.

```bash
npm install @takumi-rs/core @takumi-rs/helpers
```

```typescript
import { render } from "@takumi-rs/core";
import { container, text } from "@takumi-rs/helpers";

const layout = container({
  width: 400,
  height: 200,
  background_color: 0xffffff,
  children: [
    text("Hello from Node.js!", {
      font_size: 24,
      color: 0x000000,
    }),
  ],
});

const imageBuffer = render(layout);
```

## For Web/Browser

Compiled to WebAssembly for browser compatibility. The WASM binary is downloaded client-side. For server-side rendering, see [For Node.js/Bun](#for-nodejsbun).

Web worker integration is under development. Contributions welcome!

```bash
npm install @takumi-rs/wasm @takumi-rs/helpers
```

#### Vite

```javascript
import init, { Renderer } from "@takumi-rs/wasm";
import wasmUrl from "@takumi-rs/wasm/takumi_wasm_bg.wasm?url";

await init(wasmUrl);

const renderer = new Renderer();
```

#### Webpack

To use Takumi WASM with Webpack, you need to configure Webpack to handle `.wasm` files as assets. Add the following to your `webpack.config.js`:

```js
module.exports = {
  module: {
    rules: [
      {
        test: /\.wasm$/,
        type: 'asset/resource',
        generator: {
          filename: 'wasm/[name].[hash][ext]'
        }
      }
    ]
  }
};
```

Then, in your code, import the WASM file and initialize the module:

```js
import init, { Renderer } from '@takumi-rs/wasm';
import wasmUrl from '@takumi-rs/wasm/takumi_wasm_bg.wasm';

await init(wasmUrl);
const renderer = new Renderer();
```

#### Next.js

Next.js (with Webpack 5+) also supports importing WASM as assets. You can use the [same Webpack rule as above](#webpack) by customizing your `next.config.js`:

```js
// next.config.js
module.exports = {
  webpack(config) {
    config.module.rules.push({
      test: /\.wasm$/,
      type: 'asset/resource',
      generator: {
        filename: 'static/wasm/[name].[hash][ext]'
      }
    });
    return config;
  },
};
```

Then, import and initialize the WASM module in your component or page:

```js
import init, { Renderer } from '@takumi-rs/wasm';
import wasmUrl from '@takumi-rs/wasm/takumi_wasm_bg.wasm';

useEffect(() => {
  (async () => {
    await init(wasmUrl);
    const renderer = new Renderer();
    // ... your code ...
  })();
}, []);
```

#### No Bundler

For direct browser usage without a bundler, download files locally or use a CDN like unpkg.

```javascript
import { container, text, percentage } from "https://unpkg.com/@takumi-rs/helpers";
import init, { Renderer } from "https://unpkg.com/@takumi-rs/wasm";

await init(fetch("http://unpkg.com/@takumi-rs/wasm/takumi_wasm_bg.wasm"));

const renderer = new Renderer();
```

### Font Loading

All setups require explicit font loading for text rendering:

```javascript
// Method 1: Load from your assets
const fontResponse = await fetch('/fonts/NotoSans-Regular.ttf');
const fontData = new Uint8Array(await fontResponse.arrayBuffer());
renderer.loadFont(fontData);

// Method 2: Load multiple fonts
const fontUrls = [
  '/fonts/NotoSans-Regular.ttf',
  '/fonts/NotoSans-Bold.ttf',
  '/fonts/NotoColorEmoji.ttf'
];

for (const url of fontUrls) {
  const response = await fetch(url);
  const data = new Uint8Array(await response.arrayBuffer());
  renderer.loadFont(data);
}
```

## With Pre-built HTTP Server

Deploy a standalone HTTP server that provides image generation via REST API.

Run `takumi-server --help` for usage instructions.

### Build from Source

```bash
git clone https://github.com/kane50613/takumi.git
cd takumi
cargo build --release --bin takumi-server
```

## For Rust

See [takumi in docs.rs](https://docs.rs/takumi/latest/takumi/) for complete documentation.
